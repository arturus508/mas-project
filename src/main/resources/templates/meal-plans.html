<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Meal Plans</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<header>
  <h1>Meal Plans</h1>
  <nav>
    <ul>
      <li><a th:href="@{/dashboard}">Dashboard</a></li>
      <li><a th:href="@{/meal-plans}">Meal Plans</a></li>
    </ul>
  </nav>
</header>
<div class="content">
  <!-- Flash messages -->
  <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
  <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

  <!-- Button to add a new meal plan -->
  <a th:href="@{/meal-plans/add}" class="add-button">Add New Meal Plan</a>

  <!-- List of Meal Plans -->
  <div th:each="mealPlan : ${mealPlans}" class="meal-plan-card">
    <h3 th:text="${mealPlan.planName}"></h3>
    <p th:text="'Description: ' + ${mealPlan.description}"></p>
    <p th:text="'Dietary Restriction: ' + ${mealPlan.dietaryRestriction}"></p>
    <p th:text="'Start Date: ' + ${mealPlan.startDate}"></p>
    <p th:text="'End Date: ' + ${mealPlan.endDate}"></p>
    <div class="actions">
      <!-- Go to details page for this plan -->
      <a th:href="@{'/meal-plans/' + ${mealPlan.mealPlanId}}" class="edit-button">Go</a>
      <!-- Delete meal plan via POST to avoid accidental deletion via GET -->
      <form th:action="@{'/meal-plans/delete/' + ${mealPlan.mealPlanId}}" method="post" style="display:inline;">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit" class="delete-button" onclick="return confirm('Delete this meal plan?');">Delete</button>
      </form>
    </div>
  </div>
</div>
</body>
</html>